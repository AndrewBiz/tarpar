# Рекомендации по использованию tarpar

## Предпосылки создания tarpar

### Производственный цикл в ИТ

Типовой производственный цикл в ИТ-сфере представлен на схеме ![Цикл ИТ-изменений](assets/IT-cycle.png)

На шаге 2 Архитектор проектирует архитектуру будущего решения. В результате создается прикладная архитектурная схема уровня L1 (уровень "контекст" в терминах модели [С4 model](https://c4model.com/)). Архитектурная схема визуально отражает к какому результату нужно прийти (какие системы и интеграции доработать), чтобы решить задачу бизнеса. Архитектурная схема используется продуктовыми командами для планирования и реализации необходимых доработок ИТ-систем (шаг 3).

На шаге 4 производится передача доработок от продуктовых команд бизнес-заказчику. Архитектор присутствует при сдаче-приемке в качестве контролера - проверяет насколько корректно была реализована ранее предложенная архитектура.

### Проблемы в части архитектуры

Практика показывает, что есть проблемы в прохождении данного цикла:

1. Архитектурные схемы содержат ошибки, неоднозначно интерпретируемые участки, могут неполно передавать информацию о необходимых изменениях. Это происходит из-за того, что компании часто используют простые "рисовалки" (например [drawio](https://github.com/jgraph/drawio-desktop/releases)), при этом не устанавливают правил и нотаций по созданию схем. А специализированные архитектурные инструменты либо дороги, либо недоступны, либо в силу своей сложности не прижились в компании.

2. Для масштабных проектов (десятки систем и интеграций) получаемые схемы большие и трудно воспринимаемые человеком. Это приводит к ошибкам при интерпретации схем и планировании доработок ИТ-системы в продуктовых командах

3. На этапе приемки результатов сложно отслеживать полноту и правильность реализации, глядя только на архитектурную схему. Это снижает качество контроля и создает предпосылки к серьезным ошибкам реализации

### Подход к решению проблем

1. В качестве инструмента создания схем предлагается использовать открытый свободный продукт [drawio](https://github.com/jgraph/drawio-desktop/releases)

2. Архитектура решения описывается на уровне L1 (уровень "контекст" в терминах модели [С4 model](https://c4model.com/)). Основные объекты схемы: _система_, _пользователь_, _интеграция_

3. Нотация архитектурной схемы - максимально упрощенная и вместе с тем информативная. Нотация должна передавать визуальными средствами состояние прикладного ИТ-ландшафта компании на целевую дату с детализацией до уровня отдельной функции системы и отдельного интеграционного взаимодействия с указанием какие доработки в системах и интеграциях (по сравнению с текущим состоянием) должны быть выполнены. Описание нотации приведено в [шаблоне архитектурной схемы](../templates/L1-diagram-template.drawio) (открывать в drawio)

4. Должна быть возможность проанализировать схему на корректность, выявить в ней логические и семантические ошибки

5. Должна быть возможность выгрузить в табличный формат информацию обо всех дорабатываемых объектах, чтобы на ее основе сформировать бэклоги команд и впоследствии проконтролировать реализацию

Утилита **tarpar** предназначена для решения пунктов 4 и 5. На вход утилите подается файл с диаграммой формата drawio, на выходе формируется текстовый реестр объектов в формате csv (разделитель полей точка-с-запятой). Реестр можно загрузить в любой табличный процессор и далее провести необходимый анализ на наличие ошибок в схеме, а также сформировать данные для формирования задач в Jira или подобных системах

## Архитектурная схема ПА-L1 в drawio

### Нотация

Нотация описания прикладной архитектуры уровня L1 приведена в файле [шаблона архитектурной схемы](../templates/L1-diagram-template.drawio): ![нотация ПА-L1](assets/L1-notation.png)

### Общие рекомендации по ведению модели в drawio

Здесь и далее приведенные рекомендации предварительно были протестированы на варианте **drawio desktop** версии **24.2.5**

1. В свойствах диаграммы **отключите опции**:

   - Connection Arrows
   - Connection Points

   Это избавит от назойливого (и не всегда корректного) поведения системы при рисовании стрелок

2. **Включите использование слоев**

   Используйте **отдельный слой** для нотации (легенды). Это позволит в табличной форме быстро отфильтровать элементы нотации, отделив их от полезной информации диаграммы

3. **Используйте объекты нотации как шаблон**

   Копируйте их, создавайте дубликаты (при перетаскивании удерживайте CTRL). Не используйте объекты из стандартной палитры объектов drawio, т.к. объекты нотации были тонко настроены и эти настройки не копируются при копировании стиля (баг drawio)

4. **Используйте дополнительные поля** для ведения информации по объекту:
   - поле **tooltip** (CTRL-ALT-T) используйте для пояснения деталей работы объекта (например какие именно изменения нужно сделать в функции системы)
   - поле **team** (CTRL-M) используйте для названия продуктовой команды, ответственной за данный функционал
   - поле **tasks** (CTRL-M) можно использовать для указания идентификаторов задач в системе управления задачами (jira и т.п.)
   - поле **tags** (CTRL-K) можно использовать для расстановки меток на объекты, чтобы потом использовать фильтрацию, поиск по метке

### Объект "Система"

### Объект "Интеграция"
